<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ü•ß Pi Recitation Verifier - 300 Digits</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            height: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f0f1a 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
            color: white;
            touch-action: manipulation;
            overflow-y: auto;
        }

        /* ========== FIXED SPEED BUTTONS ON SIDES ========== */
        .fixed-speed-btn {
            position: fixed;
            top: 50%;
            transform: translateY(-50%);
            z-index: 200;
            width: 55px;
            height: 75px;
            border: none;
            border-radius: 10px;
            font-size: 1.6rem;
            font-weight: 900;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 2px;
            color: white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            transition: all 0.1s ease;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            user-select: none;
        }

        .fixed-speed-btn:active,
        .fixed-speed-btn.pressed {
            transform: translateY(-50%) scale(0.9);
            opacity: 0.85;
        }

        .fixed-speed-btn.decrease {
            left: 3px;
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .fixed-speed-btn.increase {
            right: 3px;
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .fixed-speed-btn .btn-icon {
            font-size: 1.8rem;
            line-height: 1;
            font-weight: 900;
        }

        .fixed-speed-btn .btn-label {
            font-size: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            opacity: 0.9;
        }

        .fixed-speed-btn .speed-indicator {
            font-size: 0.75rem;
            font-weight: 800;
            background: rgba(0,0,0,0.3);
            padding: 2px 6px;
            border-radius: 4px;
            margin-top: 2px;
        }

        /* Adjust container to not overlap with fixed buttons */
        .container {
            max-width: 700px;
            margin: 0 auto;
            padding: 10px 65px;
        }

        /* Tablet */
        @media (max-width: 768px) {
            .fixed-speed-btn {
                width: 50px;
                height: 70px;
            }
            .container {
                padding: 10px 58px;
            }
        }

        /* Mobile */
        @media (max-width: 600px) {
            .fixed-speed-btn {
                width: 45px;
                height: 65px;
                font-size: 1.4rem;
                border-radius: 8px;
            }
            .fixed-speed-btn .btn-icon {
                font-size: 1.5rem;
            }
            .fixed-speed-btn .btn-label {
                font-size: 0.45rem;
            }
            .fixed-speed-btn .speed-indicator {
                font-size: 0.65rem;
                padding: 2px 4px;
            }
            .container {
                padding: 10px 50px;
            }
        }

        /* Small Mobile */
        @media (max-width: 400px) {
            .fixed-speed-btn {
                width: 38px;
                height: 55px;
                font-size: 1.2rem;
                border-radius: 6px;
            }
            .fixed-speed-btn .btn-icon {
                font-size: 1.3rem;
            }
            .fixed-speed-btn .btn-label {
                display: none;
            }
            .fixed-speed-btn .speed-indicator {
                font-size: 0.6rem;
            }
            .container {
                padding: 10px 42px;
            }
        }

        /* Very Small Mobile */
        @media (max-width: 350px) {
            .fixed-speed-btn {
                width: 32px;
                height: 50px;
            }
            .fixed-speed-btn .speed-indicator {
                font-size: 0.55rem;
                padding: 1px 3px;
            }
            .container {
                padding: 10px 36px;
            }
        }

        /* Landscape mode on mobile */
        @media (max-height: 500px) and (orientation: landscape) {
            .fixed-speed-btn {
                height: 50px;
                width: 45px;
            }
            .fixed-speed-btn .btn-label {
                display: none;
            }
        }

        /* ========== STICKY HEADER ========== */
        .sticky-header {
            position: sticky;
            top: 0;
            z-index: 100;
            background: linear-gradient(135deg, #0f0f1a 0%, #1a1a2e 100%);
            padding: 8px 10px;
            border-bottom: 2px solid rgba(251, 191, 36, 0.3);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }

        .sticky-content {
            max-width: 700px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* Current Digit in Sticky Header */
        .sticky-digit-area {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .sticky-pi-prefix {
            font-size: 1.2rem;
            font-weight: 700;
            color: rgba(255,255,255,0.3);
            font-family: 'Courier New', monospace;
        }

        .sticky-prev-digits {
            display: flex;
            gap: 2px;
        }

        .sticky-prev {
            font-size: 1.1rem;
            font-family: 'Courier New', monospace;
            color: #818cf8;
            padding: 2px 4px;
            background: rgba(129, 140, 248, 0.15);
            border-radius: 4px;
        }

        .sticky-current-digit {
            font-size: 2.5rem;
            font-weight: 900;
            font-family: 'Courier New', monospace;
            color: #1a1a2e;
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            padding: 5px 12px;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(251, 191, 36, 0.5);
            min-width: 50px;
            text-align: center;
            line-height: 1;
        }

        .sticky-next-digits {
            display: flex;
            gap: 2px;
        }

        .sticky-next {
            font-size: 1.1rem;
            font-family: 'Courier New', monospace;
            color: #34d399;
            padding: 2px 4px;
            background: rgba(52, 211, 153, 0.15);
            border-radius: 4px;
        }

        /* Stats in Sticky Header */
        .sticky-stats {
            display: flex;
            gap: 12px;
            align-items: center;
            flex-wrap: wrap;
        }

        .sticky-stat {
            text-align: center;
            padding: 4px 8px;
            background: rgba(0,0,0,0.3);
            border-radius: 6px;
        }

        .sticky-stat-value {
            font-size: 1.1rem;
            font-weight: 800;
            font-family: 'Courier New', monospace;
        }

        .sticky-stat-value.position { color: #fbbf24; }
        .sticky-stat-value.time { color: #10b981; }
        .sticky-stat-value.speed { color: #8b5cf6; }

        .sticky-stat-label {
            font-size: 0.5rem;
            color: #a5b4fc;
            text-transform: uppercase;
        }

        .container {
            max-width: 700px;
            margin: 0 auto;
            padding: 10px;
        }

        /* Header */
        .header {
            text-align: center;
            padding: 10px;
        }

        .header h1 {
            font-size: clamp(1.3rem, 5vw, 1.8rem);
            font-weight: 800;
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            font-size: clamp(0.7rem, 2vw, 0.85rem);
            color: #a5b4fc;
            margin-top: 3px;
        }

        /* Mode Toggle */
        .mode-toggle {
            display: flex;
            background: rgba(255,255,255,0.1);
            border-radius: 25px;
            padding: 3px;
            margin: 8px auto;
            max-width: 260px;
        }

        .mode-btn {
            flex: 1;
            padding: 10px 12px;
            border: none;
            background: transparent;
            color: #a5b4fc;
            font-size: 0.85rem;
            font-weight: 600;
            border-radius: 22px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mode-btn.active {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: #1a1a2e;
        }

        /* Stats Panel */
        .stats-panel {
            background: rgba(255,255,255,0.08);
            border-radius: 12px;
            padding: 10px;
            margin: 6px 0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 6px;
        }

        .stat-box {
            text-align: center;
            padding: 6px 4px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
        }

        .stat-value {
            font-size: clamp(1rem, 3.5vw, 1.3rem);
            font-weight: 800;
            color: #fbbf24;
            font-family: 'Courier New', monospace;
        }

        .stat-value.time { color: #10b981; }
        .stat-value.speed { color: #8b5cf6; }
        .stat-value.remaining { color: #f59e0b; }

        .stat-label {
            font-size: 0.55rem;
            color: #a5b4fc;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: 2px;
        }

        .live-stats-row {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .live-stat { text-align: center; }

        .live-stat-value {
            font-size: clamp(1.2rem, 4vw, 1.6rem);
            font-weight: 900;
            color: #10b981;
        }

        .live-stat-label {
            font-size: 0.65rem;
            color: #6b7280;
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            margin: 8px 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #fbbf24);
            border-radius: 4px;
            transition: width 0.1s linear;
            width: 0%;
        }

        /* Main Digit Display */
        .digit-sequence-area {
            text-align: center;
            width: 100%;
            padding: 15px 10px;
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            margin-bottom: 10px;
        }

        .pi-prefix-row {
            font-size: clamp(1.2rem, 4vw, 1.6rem);
            font-weight: 700;
            color: rgba(255,255,255,0.3);
            font-family: 'Courier New', monospace;
            margin-bottom: 8px;
        }

        .digit-sequence {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 3px;
            flex-wrap: nowrap;
            overflow: hidden;
        }

        .seq-digit {
            font-family: 'Courier New', monospace;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            transition: all 0.15s ease;
        }

        .seq-digit.prev {
            font-size: clamp(1.3rem, 4vw, 2rem);
            color: #818cf8;
            padding: 4px 6px;
            background: rgba(129, 140, 248, 0.15);
            min-width: clamp(30px, 7vw, 40px);
        }

        .seq-digit.prev-far {
            font-size: clamp(1rem, 3vw, 1.5rem);
            color: #6366f1;
            opacity: 0.5;
            padding: 3px 5px;
            min-width: clamp(25px, 6vw, 35px);
        }

        .seq-digit.current {
            font-size: clamp(3.5rem, 12vw, 5.5rem);
            font-weight: 900;
            color: #1a1a2e;
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            padding: 8px 15px;
            min-width: clamp(60px, 15vw, 90px);
            box-shadow: 0 0 25px rgba(251, 191, 36, 0.5);
            animation: currentPulse 0.2s ease;
            margin: 0 6px;
            border-radius: 10px;
        }

        @keyframes currentPulse {
            0% { transform: scale(0.95); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        .seq-digit.next {
            font-size: clamp(1.3rem, 4vw, 2rem);
            color: #34d399;
            padding: 4px 6px;
            background: rgba(52, 211, 153, 0.15);
            min-width: clamp(30px, 7vw, 40px);
        }

        .seq-digit.next-far {
            font-size: clamp(1rem, 3vw, 1.5rem);
            color: #10b981;
            opacity: 0.5;
            padding: 3px 5px;
            min-width: clamp(25px, 6vw, 35px);
        }

        .seq-digit.placeholder {
            color: rgba(255,255,255,0.15);
            font-size: clamp(1rem, 3vw, 1.5rem);
            min-width: clamp(25px, 6vw, 35px);
        }

        .position-label {
            font-size: clamp(0.85rem, 2.5vw, 1rem);
            color: #a5b4fc;
            margin-top: 10px;
        }

        .color-legend {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 8px;
            font-size: 0.65rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 4px;
            color: #6b7280;
        }

        .legend-dot {
            width: 10px;
            height: 10px;
            border-radius: 3px;
        }

        .legend-dot.prev { background: #818cf8; }
        .legend-dot.current { background: linear-gradient(135deg, #fbbf24, #f59e0b); }
        .legend-dot.next { background: #34d399; }

        /* Navigation Controls */
        .nav-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin: 10px 0;
        }

        .nav-btn {
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.15s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
        }

        .nav-btn.large {
            width: 50px;
            height: 50px;
            font-size: 1.3rem;
        }

        .nav-btn.small {
            width: 40px;
            height: 40px;
            font-size: 0.7rem;
        }

        .nav-btn.back { background: linear-gradient(135deg, #6366f1, #4f46e5); }
        .nav-btn.forward { background: linear-gradient(135deg, #10b981, #059669); }
        .nav-btn.back-10 { background: rgba(99, 102, 241, 0.5); }
        .nav-btn.forward-10 { background: rgba(16, 185, 129, 0.5); }

        .nav-btn:active { transform: scale(0.9); }
        .nav-btn:disabled { opacity: 0.3; cursor: not-allowed; transform: none; }

        /* Tap Zone */
        .tap-zone {
            display: none;
            width: 100%;
            padding: 20px 15px;
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.08), rgba(245, 158, 11, 0.03));
            border: 3px dashed rgba(251, 191, 36, 0.35);
            border-radius: 12px;
            text-align: center;
            margin: 8px 0;
            cursor: pointer;
            user-select: none;
            transition: all 0.1s ease;
        }

        .tap-zone.active { display: block; }

        .tap-zone.holding {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.25), rgba(251, 191, 36, 0.15));
            border-color: #10b981;
            transform: scale(0.98);
        }

        .tap-zone-text {
            font-size: clamp(0.95rem, 3vw, 1.1rem);
            color: #fbbf24;
            font-weight: 700;
        }

        .tap-zone-hint {
            font-size: 0.7rem;
            color: #a5b4fc;
            margin-top: 5px;
        }

        /* Auto Controls */
        .auto-controls {
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            margin: 8px 0;
        }

        .auto-controls.active { display: flex; }

        .speed-control {
            display: flex;
            align-items: center;
            gap: 10px;
            width: 100%;
            max-width: 280px;
        }

        .speed-label {
            font-size: 0.75rem;
            font-weight: 600;
            min-width: 16px;
        }

        .speed-label.slow { color: #10b981; }
        .speed-label.fast { color: #ef4444; }

        .speed-slider {
            flex: 1;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(90deg, #10b981, #fbbf24, #ef4444);
            border-radius: 4px;
            outline: none;
        }

        .speed-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.4);
        }

        .speed-value {
            font-size: 0.95rem;
            font-weight: 800;
            color: #fbbf24;
            min-width: 55px;
            text-align: center;
        }

        .auto-btn-row {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .control-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .control-btn:active { transform: scale(0.95); }
        .control-btn.start { background: linear-gradient(135deg, #10b981, #059669); color: white; }
        .control-btn.pause { background: linear-gradient(135deg, #f59e0b, #d97706); color: white; }
        .control-btn.reset { background: linear-gradient(135deg, #ef4444, #dc2626); color: white; }
        .control-btn:disabled { opacity: 0.5; cursor: not-allowed; }

        /* ========== ALL 300 DIGITS ========== */
        .digits-section {
            margin: 15px 0;
        }

        .digits-section-title {
            font-size: 1rem;
            font-weight: 700;
            color: #fbbf24;
            text-align: center;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .digits-grid {
            background: rgba(0,0,0,0.4);
            border-radius: 12px;
            padding: 15px;
            border: 2px solid rgba(251, 191, 36, 0.2);
        }

        .pi-prefix-grid {
            font-size: clamp(1.3rem, 4vw, 1.8rem);
            font-weight: 800;
            color: #fbbf24;
            font-family: 'Courier New', monospace;
        }

        .pi-digits {
            font-family: 'Courier New', monospace;
            font-size: clamp(1.1rem, 3.5vw, 1.5rem);
            line-height: 2.2;
            letter-spacing: 2px;
            word-spacing: 5px;
        }

        .digit {
            display: inline-block;
            padding: 3px 5px;
            border-radius: 4px;
            color: rgba(255,255,255,0.4);
            transition: all 0.15s ease;
            margin: 1px;
        }

        .digit.past {
            color: #818cf8;
            background: rgba(129, 140, 248, 0.15);
        }

        .digit.current {
            color: #1a1a2e;
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            font-weight: 900;
            transform: scale(1.15);
            box-shadow: 0 0 12px rgba(251, 191, 36, 0.6);
        }

        .group-sep {
            display: inline-block;
            width: 12px;
        }

        /* Verification Links */
        .verify-section {
            margin-top: 15px;
            padding: 12px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
        }

        .verify-title {
            font-size: 0.8rem;
            color: #a5b4fc;
            text-align: center;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .verify-links {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            justify-content: center;
        }

        .verify-link {
            background: rgba(99, 102, 241, 0.2);
            color: #a5b4fc;
            text-decoration: none;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 0.65rem;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .verify-link:hover {
            background: rgba(99, 102, 241, 0.4);
            color: white;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 15px;
            font-size: 0.7rem;
            color: #6b7280;
            margin-top: 10px;
        }

        /* Responsive */
        @media (max-width: 500px) {
            .sticky-content {
                justify-content: center;
            }
            .sticky-stats {
                width: 100%;
                justify-content: center;
            }
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .pi-digits {
                font-size: 1rem;
                letter-spacing: 1px;
            }
            .digit {
                padding: 2px 4px;
            }
        }
    </style>
</head>
<body>
    <!-- ========== FIXED SPEED BUTTONS - Always Visible ========== -->
    <button class="fixed-speed-btn decrease" onclick="adjustSpeed(-0.5)" title="Decrease Speed">
        <span class="btn-icon">‚àí</span>
        <span class="btn-label">Slower</span>
        <span class="speed-indicator" id="speedLeft">3.0</span>
    </button>
    <button class="fixed-speed-btn increase" onclick="adjustSpeed(0.5)" title="Increase Speed">
        <span class="btn-icon">+</span>
        <span class="btn-label">Faster</span>
        <span class="speed-indicator" id="speedRight">3.0</span>
    </button>

    <!-- ========== STICKY HEADER - Always Visible ========== -->
    <div class="sticky-header">
        <div class="sticky-content">
            <!-- Current Digit with Context -->
            <div class="sticky-digit-area">
                <span class="sticky-pi-prefix">3.</span>
                <div class="sticky-prev-digits">
                    <span class="sticky-prev" id="stickyPrev1">-</span>
                    <span class="sticky-prev" id="stickyPrev2">-</span>
                </div>
                <div class="sticky-current-digit" id="stickyCurrentDigit">-</div>
                <div class="sticky-next-digits">
                    <span class="sticky-next" id="stickyNext1">1</span>
                    <span class="sticky-next" id="stickyNext2">4</span>
                </div>
            </div>

            <!-- Key Stats -->
            <div class="sticky-stats">
                <div class="sticky-stat">
                    <div class="sticky-stat-value position" id="stickyPosition">0/300</div>
                    <div class="sticky-stat-label">Position</div>
                </div>
                <div class="sticky-stat">
                    <div class="sticky-stat-value time" id="stickyTime">0:00</div>
                    <div class="sticky-stat-label">Time</div>
                </div>
                <div class="sticky-stat">
                    <div class="sticky-stat-value speed" id="stickySpeed">0.0</div>
                    <div class="sticky-stat-label">d/s</div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>ü•ß Pi Recitation Verifier</h1>
            <p>300 digits after 3. ‚Ä¢ Tap or Auto mode</p>
        </header>

        <!-- Mode Toggle -->
        <div class="mode-toggle">
            <button class="mode-btn active" id="manualModeBtn" onclick="setMode('manual')">üëÜ Manual</button>
            <button class="mode-btn" id="autoModeBtn" onclick="setMode('auto')">‚è±Ô∏è Auto</button>
        </div>

        <!-- Stats Panel -->
        <div class="stats-panel">
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-value" id="digitCount">0</div>
                    <div class="stat-label">Digits</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value time" id="elapsedTime">0:00</div>
                    <div class="stat-label">Time</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value speed" id="liveSpeed">0.0</div>
                    <div class="stat-label">Digits/Sec</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value remaining" id="remaining">300</div>
                    <div class="stat-label">Left</div>
                </div>
            </div>
            <div class="live-stats-row">
                <div class="live-stat">
                    <div class="live-stat-value" id="avgSpeed">0.0</div>
                    <div class="live-stat-label">Avg Speed (d/s)</div>
                </div>
                <div class="live-stat">
                    <div class="live-stat-value" id="estTimeLeft">--:--</div>
                    <div class="live-stat-label">Est. Time Left</div>
                </div>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>

        <!-- Main Digit Display -->
        <div class="digit-sequence-area">
            <div class="pi-prefix-row">3.</div>
            <div class="digit-sequence" id="digitSequence">
                <span class="seq-digit placeholder">-</span>
                <span class="seq-digit placeholder">-</span>
                <span class="seq-digit current">-</span>
                <span class="seq-digit next">1</span>
                <span class="seq-digit next-far">4</span>
            </div>
            <div class="position-label" id="positionLabel">Ready to start</div>
            <div class="color-legend">
                <div class="legend-item"><div class="legend-dot prev"></div><span>Previous</span></div>
                <div class="legend-item"><div class="legend-dot current"></div><span>Current</span></div>
                <div class="legend-item"><div class="legend-dot next"></div><span>Next</span></div>
            </div>
        </div>

        <!-- Navigation Controls -->
        <div class="nav-controls">
            <button class="nav-btn small back-10" onclick="navigate(-10)">-10</button>
            <button class="nav-btn large back" id="backBtn" onclick="navigate(-1)">‚óÄ</button>
            <button class="nav-btn large forward" id="forwardBtn" onclick="navigate(1)">‚ñ∂</button>
            <button class="nav-btn small forward-10" onclick="navigate(10)">+10</button>
        </div>

        <!-- Manual Mode: Tap Zone -->
        <div class="tap-zone active" id="tapZone">
            <div class="tap-zone-text" id="tapText">üëÜ TAP to advance</div>
            <div class="tap-zone-hint">Hold for continuous ‚Ä¢ Use ‚óÄ‚ñ∂ for back/forward</div>
        </div>

        <!-- Auto Mode: Speed Controls -->
        <div class="auto-controls" id="autoControls">
            <div class="speed-control">
                <span class="speed-label slow">1</span>
                <input type="range" class="speed-slider" id="speedSlider" min="1" max="6" step="0.5" value="3">
                <span class="speed-label fast">6</span>
                <div class="speed-value" id="speedValue">3.0/s</div>
            </div>
            <div class="auto-btn-row">
                <button class="control-btn start" id="startBtn" onclick="startAuto()">‚ñ∂Ô∏è Start</button>
                <button class="control-btn pause" id="pauseBtn" onclick="pauseAuto()" disabled>‚è∏Ô∏è Pause</button>
                <button class="control-btn reset" id="resetBtn" onclick="resetAll()">üîÑ Reset</button>
            </div>
        </div>

        <!-- ========== ALL 300 DIGITS ========== -->
        <div class="digits-section">
            <div class="digits-section-title">üìã All 300 Digits</div>
            <div class="digits-grid" id="digitsGrid">
                <span class="pi-prefix-grid">3.</span>
                <span class="pi-digits" id="piDigitsContainer"></span>
            </div>
        </div>

        <!-- Official Verification Links -->
        <div class="verify-section">
            <div class="verify-title">üîç Verify Pi Digits - Official Sources</div>
            <div class="verify-links">
                <a href="https://www.piday.org/million/" target="_blank" class="verify-link">ü•ß PiDay.org (1M digits)</a>
                <a href="https://www.angio.net/pi/digits.html" target="_blank" class="verify-link">üî¢ Angio.net</a>
                <a href="https://www.math.com/tables/constants/pi.htm" target="_blank" class="verify-link">üìê Math.com</a>
                <a href="https://oeis.org/A000796" target="_blank" class="verify-link">üßÆ OEIS A000796</a>
                <a href="https://www.wolframalpha.com/input?i=first+300+digits+of+pi" target="_blank" class="verify-link">üê∫ Wolfram Alpha</a>
                <a href="https://stuff.mit.edu/afs/sipb/contrib/pi/" target="_blank" class="verify-link">üéì MIT (1B digits)</a>
            </div>
        </div>

        <!-- Professional Pi Community Links -->
        <div class="verify-section">
            <div class="verify-title">üèÜ Professional Pi Recitation Community</div>
            <div class="verify-links">
                <a href="https://www.pi-world-ranking-list.com/?page=lists&category=pi" target="_blank" class="verify-link">üåç Pi World Ranking List</a>
                <a href="https://www.worldpifederation.org/" target="_blank" class="verify-link">üèÖ World Pi Federation</a>
                <a href="https://memory-pi.andreharnist.fr/" target="_blank" class="verify-link">üéÆ Memory Pi Game</a>
                <a href="https://www.piday.org/pi-quiz/" target="_blank" class="verify-link">üìù Pi Quiz (150 digits)</a>
                <a href="https://forum.artofmemory.com/" target="_blank" class="verify-link">üí¨ Art of Memory Forum</a>
                <a href="https://www.teachpi.org/activities/contests/" target="_blank" class="verify-link">üéØ TeachPi Contests</a>
            </div>
        </div>

        <!-- NASA & Scientific Links -->
        <div class="verify-section">
            <div class="verify-title">üöÄ NASA & Scientific Resources</div>
            <div class="verify-links">
                <a href="https://www.jpl.nasa.gov/edu/resources/teachable-moment/pi-goes-the-distance-at-nasa/" target="_blank" class="verify-link">üõ∏ NASA JPL Pi Day</a>
                <a href="https://pi2e.ch/blog/2017/03/10/pi-digits-download/" target="_blank" class="verify-link">üì• Pi2e.ch Downloads</a>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>üß† Created for memory athletes by <strong>Dineshkumar Rajendran</strong></p>
        </footer>
    </div>

    <script>
        // First 300 digits of Pi after the decimal point
        const PI_DIGITS = "141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117067982148086513282306647093844609550582231725359408128481117450284102701938521105559644622948954930381964428810975665933446128475648233786783165271201909145648566923460348610454326648213393607260249141273724587006606315588174881520920962829254091715364367892590360011330530548820466521384146951941511609";

        // State
        let currentIndex = -1;
        let mode = 'manual';
        let isRunning = false;
        let isPaused = false;
        let autoInterval = null;
        let speed = 3;

        // Timing
        let startTime = null;
        let totalElapsed = 0;
        let pauseStart = null;
        let timerInterval = null;
        let holdInterval = null;
        let isHolding = false;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initDigitsGrid();
            updateDisplay();
            setupTapZone();
            setupSpeedSlider();
            setupFixedSpeedButtons();
            startTimer();
        });

        // Initialize digits grid
        function initDigitsGrid() {
            const container = document.getElementById('piDigitsContainer');
            let html = '';
            for (let i = 0; i < PI_DIGITS.length; i++) {
                html += `<span class="digit" id="digit-${i}">${PI_DIGITS[i]}</span>`;
                if ((i + 1) % 5 === 0 && i < PI_DIGITS.length - 1) {
                    html += '<span class="group-sep"></span>';
                }
                if ((i + 1) % 50 === 0) {
                    html += '<br>';
                }
            }
            container.innerHTML = html;
        }

        // Update digit sequence display
        function updateDigitSequence() {
            const container = document.getElementById('digitSequence');
            let html = '';
            
            // Show 2 previous digits
            for (let i = currentIndex - 2; i < currentIndex; i++) {
                if (i < 0) {
                    html += `<span class="seq-digit placeholder">-</span>`;
                } else {
                    const farClass = i === currentIndex - 2 ? 'prev-far' : 'prev';
                    html += `<span class="seq-digit ${farClass}">${PI_DIGITS[i]}</span>`;
                }
            }
            
            // Current digit
            if (currentIndex < 0) {
                html += `<span class="seq-digit current">-</span>`;
            } else if (currentIndex >= PI_DIGITS.length) {
                html += `<span class="seq-digit current">‚úì</span>`;
            } else {
                html += `<span class="seq-digit current">${PI_DIGITS[currentIndex]}</span>`;
            }
            
            // Show 2 next digits
            for (let i = currentIndex + 1; i <= currentIndex + 2; i++) {
                if (i >= PI_DIGITS.length) {
                    html += `<span class="seq-digit placeholder">-</span>`;
                } else if (currentIndex < 0) {
                    const idx = i;
                    const farClass = i === currentIndex + 2 ? 'next-far' : 'next';
                    html += `<span class="seq-digit ${farClass}">${PI_DIGITS[idx]}</span>`;
                } else {
                    const farClass = i === currentIndex + 2 ? 'next-far' : 'next';
                    html += `<span class="seq-digit ${farClass}">${PI_DIGITS[i]}</span>`;
                }
            }
            
            container.innerHTML = html;
        }

        // Update sticky header
        function updateStickyHeader() {
            // Current digit
            const stickyDigit = document.getElementById('stickyCurrentDigit');
            if (currentIndex < 0) {
                stickyDigit.textContent = '-';
            } else if (currentIndex >= PI_DIGITS.length) {
                stickyDigit.textContent = '‚úì';
            } else {
                stickyDigit.textContent = PI_DIGITS[currentIndex];
            }

            // Previous digits
            document.getElementById('stickyPrev1').textContent = currentIndex >= 2 ? PI_DIGITS[currentIndex - 2] : '-';
            document.getElementById('stickyPrev2').textContent = currentIndex >= 1 ? PI_DIGITS[currentIndex - 1] : '-';

            // Next digits
            document.getElementById('stickyNext1').textContent = currentIndex + 1 < PI_DIGITS.length ? PI_DIGITS[currentIndex + 1] : '-';
            document.getElementById('stickyNext2').textContent = currentIndex + 2 < PI_DIGITS.length ? PI_DIGITS[currentIndex + 2] : '-';

            // Position
            const pos = Math.max(0, currentIndex + 1);
            document.getElementById('stickyPosition').textContent = `${pos}/300`;
        }

        // Setup tap zone
        function setupTapZone() {
            const tapZone = document.getElementById('tapZone');
            
            tapZone.addEventListener('touchstart', handleTapStart, { passive: false });
            tapZone.addEventListener('touchend', handleTapEnd);
            tapZone.addEventListener('touchcancel', handleTapEnd);
            
            tapZone.addEventListener('mousedown', handleTapStart);
            tapZone.addEventListener('mouseup', handleTapEnd);
            tapZone.addEventListener('mouseleave', handleTapEnd);
        }

        function handleTapStart(e) {
            e.preventDefault();
            if (mode !== 'manual') return;
            
            if (startTime === null && currentIndex === -1) {
                startTime = Date.now();
            }
            
            const tapZone = document.getElementById('tapZone');
            tapZone.classList.add('holding');
            document.getElementById('tapText').textContent = '‚è© Advancing...';
            
            navigate(1);
            
            isHolding = true;
            holdInterval = setInterval(() => {
                if (isHolding && currentIndex < PI_DIGITS.length - 1) {
                    navigate(1);
                }
            }, 180);
        }

        function handleTapEnd() {
            if (mode !== 'manual') return;
            
            const tapZone = document.getElementById('tapZone');
            tapZone.classList.remove('holding');
            document.getElementById('tapText').textContent = 'üëÜ TAP to advance';
            
            isHolding = false;
            if (holdInterval) {
                clearInterval(holdInterval);
                holdInterval = null;
            }
        }

        // Setup speed slider
        function setupSpeedSlider() {
            const slider = document.getElementById('speedSlider');
            slider.addEventListener('input', function() {
                speed = parseFloat(this.value);
                updateSpeedDisplays();
                
                if (isRunning && !isPaused) {
                    clearInterval(autoInterval);
                    autoInterval = setInterval(autoAdvance, 1000 / speed);
                }
                
                updateEstimatedTime();
            });
        }

        // Adjust speed from fixed buttons
        function adjustSpeed(delta) {
            speed = Math.max(1, Math.min(6, speed + delta));
            speed = Math.round(speed * 10) / 10; // Fix floating point issues
            document.getElementById('speedSlider').value = speed;
            updateSpeedDisplays();
            
            if (isRunning && !isPaused) {
                clearInterval(autoInterval);
                autoInterval = setInterval(autoAdvance, 1000 / speed);
            }
            
            updateEstimatedTime();
        }

        // Setup fixed speed buttons for touch devices
        function setupFixedSpeedButtons() {
            const decreaseBtn = document.querySelector('.fixed-speed-btn.decrease');
            const increaseBtn = document.querySelector('.fixed-speed-btn.increase');
            
            // Prevent default touch behaviors and handle touch events
            [decreaseBtn, increaseBtn].forEach(btn => {
                btn.addEventListener('touchstart', function(e) {
                    e.preventDefault();
                    this.classList.add('pressed');
                }, { passive: false });
                
                btn.addEventListener('touchend', function(e) {
                    e.preventDefault();
                    this.classList.remove('pressed');
                    // Trigger the click action
                    const delta = this.classList.contains('decrease') ? -0.5 : 0.5;
                    adjustSpeed(delta);
                }, { passive: false });
                
                btn.addEventListener('touchcancel', function() {
                    this.classList.remove('pressed');
                });
            });
        }

        // Update all speed displays
        function updateSpeedDisplays() {
            const speedStr = speed.toFixed(1);
            document.getElementById('speedValue').textContent = speedStr + '/s';
            document.getElementById('speedLeft').textContent = speedStr;
            document.getElementById('speedRight').textContent = speedStr;
        }

        // Timer
        function startTimer() {
            timerInterval = setInterval(updateTimer, 100);
        }

        function updateTimer() {
            if (startTime === null) return;
            
            let elapsed;
            if (isPaused && pauseStart) {
                elapsed = (pauseStart - startTime) / 1000;
            } else {
                elapsed = (Date.now() - startTime) / 1000;
            }
            
            totalElapsed = elapsed;
            
            const mins = Math.floor(elapsed / 60);
            const secs = Math.floor(elapsed % 60);
            const timeStr = `${mins}:${secs.toString().padStart(2, '0')}`;
            document.getElementById('elapsedTime').textContent = timeStr;
            document.getElementById('stickyTime').textContent = timeStr;
            
            if (currentIndex >= 0 && elapsed > 0) {
                const liveSpeed = (currentIndex + 1) / elapsed;
                document.getElementById('liveSpeed').textContent = liveSpeed.toFixed(1);
                document.getElementById('avgSpeed').textContent = liveSpeed.toFixed(2);
                document.getElementById('stickySpeed').textContent = liveSpeed.toFixed(1);
            }
            
            updateEstimatedTime();
        }

        function updateEstimatedTime() {
            const remaining = PI_DIGITS.length - (currentIndex + 1);
            document.getElementById('remaining').textContent = remaining;
            
            let estSeconds;
            if (mode === 'auto') {
                estSeconds = remaining / speed;
            } else {
                if (totalElapsed > 0 && currentIndex >= 0) {
                    const avgSpeed = (currentIndex + 1) / totalElapsed;
                    estSeconds = avgSpeed > 0 ? remaining / avgSpeed : 0;
                } else {
                    estSeconds = 0;
                }
            }
            
            if (estSeconds > 0 && remaining > 0) {
                const mins = Math.floor(estSeconds / 60);
                const secs = Math.floor(estSeconds % 60);
                document.getElementById('estTimeLeft').textContent = `${mins}:${secs.toString().padStart(2, '0')}`;
            } else if (remaining === 0) {
                document.getElementById('estTimeLeft').textContent = 'Done!';
            } else {
                document.getElementById('estTimeLeft').textContent = '--:--';
            }
        }

        // Mode switching
        function setMode(newMode) {
            mode = newMode;
            
            document.getElementById('manualModeBtn').classList.toggle('active', mode === 'manual');
            document.getElementById('autoModeBtn').classList.toggle('active', mode === 'auto');
            
            document.getElementById('tapZone').classList.toggle('active', mode === 'manual');
            document.getElementById('autoControls').classList.toggle('active', mode === 'auto');
            
            if (mode === 'manual' && isRunning) {
                pauseAuto();
            }
        }

        // Auto-scroll function: scrolls only when digit is below visible area
        function autoScrollToDigit(digitElement) {
            const rect = digitElement.getBoundingClientRect();
            const viewportHeight = window.innerHeight;
            
            // Only auto-scroll if the digit is below the visible viewport
            if (rect.bottom > viewportHeight - 50) {
                digitElement.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'center' 
                });
            }
        }

        // Navigation
        function navigate(delta) {
            const newIndex = currentIndex + delta;
            
            if (newIndex < -1 || newIndex >= PI_DIGITS.length) return;
            
            if (startTime === null && delta > 0) {
                startTime = Date.now();
            }
            
            // Update grid display
            if (currentIndex >= 0) {
                const prevDigit = document.getElementById(`digit-${currentIndex}`);
                if (prevDigit) {
                    prevDigit.classList.remove('current');
                    if (newIndex > currentIndex) {
                        prevDigit.classList.add('past');
                    }
                }
            }
            
            currentIndex = newIndex;
            
            // Handle going backwards
            if (delta < 0) {
                for (let i = currentIndex + 1; i < PI_DIGITS.length; i++) {
                    const digit = document.getElementById(`digit-${i}`);
                    if (digit) {
                        digit.classList.remove('past', 'current');
                    }
                }
            }
            
            // Update grid current
            if (currentIndex >= 0) {
                const currDigit = document.getElementById(`digit-${currentIndex}`);
                if (currDigit) {
                    currDigit.classList.remove('past');
                    currDigit.classList.add('current');
                    
                    // Auto-scroll: only scroll if current digit is below visible area
                    autoScrollToDigit(currDigit);
                }
            }
            
            updateDisplay();
            
            if (currentIndex >= PI_DIGITS.length - 1) {
                completeRecitation();
            }
        }

        // Update all displays
        function updateDisplay() {
            updateDigitSequence();
            updateStickyHeader();
            
            const posLabel = document.getElementById('positionLabel');
            if (currentIndex >= 0) {
                posLabel.textContent = `Digit ${currentIndex + 1} of 300`;
            } else {
                posLabel.textContent = 'Ready to start';
            }
            
            document.getElementById('digitCount').textContent = Math.max(0, currentIndex + 1);
            
            const progress = ((currentIndex + 1) / PI_DIGITS.length) * 100;
            document.getElementById('progressBar').style.width = Math.max(0, progress) + '%';
            
            document.getElementById('backBtn').disabled = currentIndex < 0;
            document.getElementById('forwardBtn').disabled = currentIndex >= PI_DIGITS.length - 1;
            
            updateEstimatedTime();
        }

        // Auto mode
        function startAuto() {
            if (isRunning && !isPaused) return;
            
            if (startTime === null) {
                startTime = Date.now();
            } else if (isPaused) {
                startTime += Date.now() - pauseStart;
            }
            
            isRunning = true;
            isPaused = false;
            pauseStart = null;
            
            autoInterval = setInterval(autoAdvance, 1000 / speed);
            
            document.getElementById('startBtn').disabled = true;
            document.getElementById('pauseBtn').disabled = false;
        }

        function pauseAuto() {
            if (!isRunning || isPaused) return;
            
            isPaused = true;
            pauseStart = Date.now();
            
            clearInterval(autoInterval);
            autoInterval = null;
            
            document.getElementById('startBtn').disabled = false;
            document.getElementById('pauseBtn').disabled = true;
        }

        function autoAdvance() {
            if (currentIndex < PI_DIGITS.length - 1) {
                navigate(1);
            } else {
                completeRecitation();
            }
        }

        // Reset
        function resetAll() {
            clearInterval(autoInterval);
            autoInterval = null;
            isRunning = false;
            isPaused = false;
            
            startTime = null;
            totalElapsed = 0;
            pauseStart = null;
            
            currentIndex = -1;
            
            document.querySelectorAll('.digit').forEach(d => {
                d.classList.remove('current', 'past');
            });
            
            document.getElementById('elapsedTime').textContent = '0:00';
            document.getElementById('stickyTime').textContent = '0:00';
            document.getElementById('liveSpeed').textContent = '0.0';
            document.getElementById('stickySpeed').textContent = '0.0';
            document.getElementById('avgSpeed').textContent = '0.0';
            document.getElementById('estTimeLeft').textContent = '--:--';
            
            document.getElementById('startBtn').disabled = false;
            document.getElementById('pauseBtn').disabled = true;
            
            updateDisplay();
        }

        // Complete
        function completeRecitation() {
            clearInterval(autoInterval);
            autoInterval = null;
            isRunning = false;
            
            document.getElementById('positionLabel').textContent = `üéâ Completed 300 digits in ${document.getElementById('elapsedTime').textContent}!`;
            document.getElementById('estTimeLeft').textContent = 'Done!';
            
            document.getElementById('startBtn').disabled = true;
            document.getElementById('pauseBtn').disabled = true;
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            switch(e.code) {
                case 'Space':
                    e.preventDefault();
                    if (mode === 'manual') {
                        navigate(1);
                        if (startTime === null) startTime = Date.now();
                    } else {
                        if (!isRunning || isPaused) startAuto();
                        else pauseAuto();
                    }
                    break;
                case 'ArrowRight':
                    e.preventDefault();
                    navigate(1);
                    break;
                case 'ArrowLeft':
                    e.preventDefault();
                    navigate(-1);
                    break;
                case 'ArrowUp':
                    e.preventDefault();
                    navigate(10);
                    break;
                case 'ArrowDown':
                    e.preventDefault();
                    navigate(-10);
                    break;
                case 'KeyR':
                    resetAll();
                    break;
                case 'KeyM':
                    setMode(mode === 'manual' ? 'auto' : 'manual');
                    break;
                case 'Equal':
                case 'NumpadAdd':
                    e.preventDefault();
                    adjustSpeed(0.5);
                    break;
                case 'Minus':
                case 'NumpadSubtract':
                    e.preventDefault();
                    adjustSpeed(-0.5);
                    break;
            }
        });
    </script>
</body>
</html>
